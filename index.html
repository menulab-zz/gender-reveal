<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>캡틴이 젠더리빌</title>
<title>NEW-V20260224</title>

<style>
:root{
  --bg1:#fff7fb;
  --bg2:#f2f8ff;
  --text:#111827;
  --muted:#6b7280;
  --radius:22px;
  font-family:"Noto Sans KR",system-ui,-apple-system,Segoe UI,Roboto;
}

*{box-sizing:border-box}

html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  overflow-x:hidden;
}

body{
  background:
    radial-gradient(800px 500px at 20% 10%, var(--bg1), transparent 60%),
    radial-gradient(800px 500px at 80% 20%, var(--bg2), transparent 60%),
    #fff;
  display:flex;
  justify-content:center;
  padding:20px 14px 40px;
}

.wrap{
  width:100%;
  max-width:820px;
}

.title{
  text-align:center;
  font-weight:900;
  font-size:22px;
  margin-bottom:14px;
}

.card{
  background:#ffffffcc;
  border-radius:var(--radius);
  overflow:hidden;
  position:relative;
}

.scratchBox{
  position:relative;
  width:100%;
  height:60vh;              /* Fold 대응: 고정 비율 대신 vh */
  min-height:340px;
  max-height:720px;
  background:#f4f6fa;
}

.prize{
  position:absolute;
  inset:0;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  padding:20px;
  z-index:2;
}

.winText{
  font-size:42px;
  font-weight:1000;
  display:none;
  background:linear-gradient(90deg,#ff6ea3,#ffb3d1);
  -webkit-background-clip:text;
  color:transparent;
}

.winText.show{display:block;}

.babyImg{
  width:85%;
  max-width:500px;
  margin-top:10px;
  display:none;
  border-radius:18px;
}

.babyImg.show{display:block;}

.subText{
  margin-top:14px;
  font-size:15px;
  color:var(--muted);
  font-weight:700;
  display:none;
}

.subText.show{display:block;}

#scratchCanvas{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  touch-action:none;
  z-index:3;
}

#fx{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:0;
  display:none;
}

#fx.show{display:block;}

.btnWrap{
  margin-top:12px;
  text-align:center;
}

button{
  border:none;
  padding:10px 16px;
  border-radius:14px;
  font-weight:900;
  background:#111;
  color:white;
  cursor:pointer;
}

.spark{
  position:absolute;
  font-size:18px;
  animation:rise 2.4s linear forwards;
  pointer-events:none;
  z-index:1;
}

@keyframes rise{
  0%{opacity:0;transform:translateY(0);}
  20%{opacity:1;}
  100%{opacity:0;transform:translateY(-220px);}
}
</style>
</head>
<body>

<canvas id="fx"></canvas>

<div class="wrap">
  <div class="title">캡틴이의 성별이 궁금한가요?</div>

  <div class="card">
    <div class="scratchBox" id="scratchBox">

      <div class="prize">
        <!-- ✅ 멘트 수정 -->
        <div class="winText" id="winText">✨공주님✨</div>
        <img src="baby.png" id="babyImg" class="babyImg">
        <div class="subText" id="subText">
          우리 가족에게 새로운 기쁨이 찾아왔어요.
        </div>
      </div>

      <canvas id="scratchCanvas"></canvas>

    </div>
  </div>

  <div class="btnWrap">
    <button onclick="resetAll()">다시 하기</button>
  </div>
</div>

<script>
const canvas = document.getElementById("scratchCanvas");
const box = document.getElementById("scratchBox");
const ctx = canvas.getContext("2d");

const winText = document.getElementById("winText");
const babyImg = document.getElementById("babyImg");
const subText = document.getElementById("subText");

let revealed=false;
let drawing=false;

function resizeCanvas(){
  const rect = box.getBoundingClientRect();
  canvas.width = rect.width;
  canvas.height = rect.height;
  ctx.fillStyle="#c7bfd6";
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.globalCompositeOperation="destination-out";
}
resizeCanvas();
window.addEventListener("resize",resizeCanvas);

function scratch(x,y){
  ctx.beginPath();
  ctx.arc(x,y,30,0,Math.PI*2);
  ctx.fill();
}

canvas.addEventListener("pointerdown",e=>{
  drawing=true;
});
canvas.addEventListener("pointermove",e=>{
  if(!drawing||revealed)return;
  const rect=canvas.getBoundingClientRect();
  scratch(e.clientX-rect.left,e.clientY-rect.top);
});
canvas.addEventListener("pointerup",()=>{
  drawing=false;
  checkReveal();
});

function checkReveal(){
  const imgData=ctx.getImageData(0,0,canvas.width,canvas.height);
  let cleared=0;
  for(let i=3;i<imgData.data.length;i+=4){
    if(imgData.data[i]===0) cleared++;
  }
  if(cleared/imgData.data.length>0.35){
    reveal();
  }
}

function reveal(){
  if(revealed)return;
  revealed=true;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  winText.classList.add("show");
  babyImg.classList.add("show");
  subText.classList.add("show");
  fireworks();
}

function resetAll(){
  revealed=false;
  resizeCanvas();
  winText.classList.remove("show");
  babyImg.classList.remove("show");
  subText.classList.remove("show");
}

/* ===== fireworks (behind image) ===== */
const fx=document.getElementById("fx");
const fxCtx=fx.getContext("2d");

function resizeFx(){
  fx.width=window.innerWidth;
  fx.height=window.innerHeight;
}
resizeFx();
window.addEventListener("resize",resizeFx);

function fireworks(){
  fx.classList.add("show");
  let particles=[];
  for(let i=0;i<100;i++){
    particles.push({
      x:window.innerWidth/2,
      y:window.innerHeight/3,
      vx:(Math.random()-0.5)*8,
      vy:(Math.random()-0.5)*8,
      life:60
    });
  }
  function animate(){
    fxCtx.clearRect(0,0,fx.width,fx.height);
    particles.forEach(p=>{
      p.x+=p.vx;
      p.y+=p.vy;
      p.life--;
      fxCtx.fillStyle="hsl("+Math.random()*360+",80%,60%)";
      fxCtx.fillRect(p.x,p.y,3,3);
    });
    particles=particles.filter(p=>p.life>0);
    if(particles.length>0) requestAnimationFrame(animate);
    else fx.classList.remove("show");
  }
  animate();
}
</script>
</body>
</html>
